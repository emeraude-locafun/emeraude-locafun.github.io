---
import "../../styles/global.css";

import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.vue';
import NewsCard from '../../components/NewsCard.astro';
import Contact from '../../components/Contact.astro';
import { getCollection } from 'astro:content';

// Récupérer toutes les news et trier par date
const allNews = (await getCollection('news')).sort(
	(a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf()
);
---

<Layout title="Actualités | Émeraude Loca-fun">
  <Header client:load />

  <main class="bg-gray-50 min-h-screen">
    
    <!-- En-tête simple -->
    <div class="bg-emerald-900 text-white py-16">
      <div class="max-w-7xl mx-auto px-4 text-center">
        <h1 class="text-4xl font-bold font-heading mb-4">Actualités & Événements</h1>
        <p class="text-emerald-200 text-lg max-w-2xl mx-auto">
          Retrouvez les dernières infos de la base nautique, les horaires des marées exceptionnelles et nos événements.
        </p>
      </div>
    </div>

    <!-- Grille de toutes les news -->
    <section class="max-w-7xl mx-auto px-4 py-16">
      {allNews.length > 0 ? (
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
          {allNews.map(news => (
            <NewsCard 
              title={news.data.title}
              publishDate={news.data.publishDate}
              excerpt={news.data.excerpt}
              image={news.data.image}
              slug={news.slug}
            />
          ))}
        </div>
      ) : (
        <div class="text-center py-20 text-gray-500">
          <p class="text-xl">Aucune actualité pour le moment. La saison arrive ! ☀️</p>
        </div>
      )}
    </section>

    <Contact />
  </main>
</Layout>